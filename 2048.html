<html>
<head>
<style type="text/css">
			#main
			{
				width: 290px;
				height: 290px;
				margin: 0;
				position: absolute;
				background-color: brown;
				border-radius: 5px;
			}
			.mini
			{
				width: 60px;
				height: 60px;
				margin: 0;
				position: absolute;
				background-color: red;
				border-radius: 5px;
			}
			.tile
			{
				width: 60px;
				height: 60px;
				margin: 0;
				padding: 0;
				position: absolute;
				background-color: red;
				border-radius: 5px;
				font-size: 20pt;
				font-weight: 500;
				color: white;
                text-align: center;
                vertical-align: middle;
				z-index: 100;
			}
			body
			{
				margin: 0px;
				padding: 0px;
			}
		</style>
<script type="text/javascript">
			var nodeTest ;
            var board =
            [
                [0,0,0,0],
                [0,0,0,0],
                [0,0,0,0],
                [0,0,0,0],
            ];
			function start()
			{
				var mainNode = document.getElementById('main');

				for(var i = 0 ; i < 4; i++)
				{
					for(var j = 0 ; j < 4; j++)
					{
						var node = document.createElement("div");  


						node.setAttribute("id", "x" + i +","+j);

						node.className = "mini";
						var r,g,b;
						r = Math.round(200);
						g = Math.round(200);
						b = Math.round(200);

						node.style.backgroundColor = "rgb("+r+","+g+","+b+")";

						node.style.left = (j * (60+10) + 10 );
						node.style.top =  (i * (60+10) + 10 );
						
						mainNode.appendChild(node); 

					}
				}
				var bodyNode = document.getElementById('body');

				
				nodeTest=  addTile(1,2,2);



				 document.onkeydown= function(event) 
				 {
			        var key= (event || window.event).keyCode;
			        console.log(key);
			        var rect_ball = nodeTest.div.getBoundingClientRect();
			        //nodeTest.goBig( rect_ball.left,rect_ball.top);

			        if(key == "65")
			        {
			        	nodeTest.goBig( rect_ball.left,rect_ball.top);
			        }
			        if(key == "38")
			        {
			        	nodeTest.goDirection ("up",rect_ball.left,rect_ball.top)
			        }
			         if(key == "40")
			        {
			        	nodeTest.goDirection ("down",rect_ball.left,rect_ball.top)
			        }
			         if(key == "37")
			        {
			        	nodeTest.goDirection ("left",rect_ball.left,rect_ball.top)
			        }
			         if(key == "39")
			        {
			        	nodeTest.goDirection ("right",rect_ball.left,rect_ball.top)
			        }
			        return false;
			    };
			}
			function addTile(x,y,number)
			{
				var mainNode = document.getElementById('main');
				var node = document.createElement("div");  


				node.setAttribute("id", "t" + x +","+y);

				node.className = "tile";
				node.innerHTML = "" +number;
				var r,g,b;
				r = Math.round(Math.random()*50 + 200);
				g = Math.round(Math.random()*100+100);
				b = Math.round(Math.random()*100+100);

				node.style.backgroundColor = "rgb("+r+","+g+","+b+")";

				var pos_x = (x * (60+10) + 10 );
				var pos_y = (y * (60+10) + 10 );
				node.style.left = pos_x;
				node.style.top =  pos_y;
				
				mainNode.appendChild(node); 

				var aNumberTile = {div:node,
					i:x, j:y, 
					number:number, 
					pos_x : pos_x , pos_y :pos_y,
					goBig_i : 0,
					};

				aNumberTile.goBig = goBig;
				aNumberTile.goDirection = goDirection;
				
                board [y] [x] = number;
                return aNumberTile;
			}

			function goBig(x_old,y_old)
			{
				this.goBig_i += 0.09;
				//console.log("xxx" + div.goBig_i);
				// console.log(x_old+","+y_old);
				var n = Math.sin(this.goBig_i) * 50;

				var rect_ball = this.div.getBoundingClientRect();
				this.div.style.left = x_old -n;
				this.div.style.top = y_old -n;
				this.div.style.width = 60 + n*2;
				this.div.style.height = 60 + n*2;
				console.log(this.div.style.left+" , "+this.div.style.top +"   " +  n);

				if(this.goBig_i > Math.PI)
				{
					this.div.style.left = x_old;
					this.div.style.top = y_old;

					this.div.style.width = 60 ;
					this.div.style.height = 60;
					this.goBig_i = 0 ;
				}
				else
				{
					var _this = this;
					window.setTimeout(
						function () {_this.goBig(x_old,y_old);}
						, 1);
				}
				
			}

			function goDirection(direction,x_old,y_old)
			{

				this.goBig_i += 0.09;
				var n = Math.sin(this.goBig_i) * (60+10);

				var rect_ball = this.div.getBoundingClientRect();
				
				
				if(direction == "left")
				{
					this.div.style.left = x_old -n;
				}
				else if(direction == "right")
				{
					this.div.style.left = x_old +n;
				}
				else if(direction == "up")
				{
					this.div.style.top = y_old -n;
				}
				else if(direction == "down")
				{
					this.div.style.top = y_old +n;
				}



				if(this.goBig_i > Math.PI/2)
				{
					if(direction == "left")
					{
						this.div.style.left = x_old -(60+10);
					}
					else if(direction == "right")
					{
						this.div.style.left = x_old +(60+10);
					}
					else if(direction == "up")
					{
						this.div.style.top = y_old -(60+10);
					}
					else if(direction == "down")
					{
						this.div.style.top = y_old +(60+10);
					}
					this.div.style.width = 60 ;
					this.div.style.height = 60;
					this.goBig_i = 0 ;
				}
				else
				{
					var _this = this;
					window.setTimeout(
						function () {_this.goDirection(direction,x_old,y_old);}
						, 1);
				}
			}

			
		</script>
<script src="ept1.js"></script>
</head>
<body onload="start()" id="body">
<div id="main">
</div>
</body>
</html>